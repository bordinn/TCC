<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FYT ‚Äì An√°lise por Departamento</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: 'Segoe UI', sans-serif; margin: 0; background-color: #f5f5f5; }
    
    /* HEADER PADRONIZADO */
    header { 
      background-color: #e07b3c; 
      color: white; 
      padding: 20px 30px; 
      display: flex; 
      justify-content: space-between; 
      align-items: center; 
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .header-title { 
      font-size: 24px; 
      font-weight: bold; 
    }
    .header-badges { 
      display: flex; 
      gap: 10px; 
      align-items: center;
    }
    .badge { 
      padding: 6px 14px; 
      border-radius: 4px;
      font-size: 13px; 
      font-weight: 600; 
      background: rgba(255,255,255,0.2);
    }
    .badge-cha { 
      background: #28a745; 
    }
    .badge-ia { 
      background: #4caf50; 
    }
    
    .container { padding: 20px; }
    h2 { margin-top: 0; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; background-color: white; border-radius: 2px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    th, td { padding: 10px 12px; border-bottom: 1px solid #ddd; text-align: left; }
    th { background-color: #f1f1f1; font-weight: 600; color: #333; }
    th:nth-child(1), td:nth-child(1) { background-color: #e8f4f8; font-weight: bold; text-align: center; color: #2563eb; }
    th:nth-child(2), td:nth-child(2) { background-color: #f0f9ff; font-weight: bold; text-align: center; color: #1d4ed8; }
    tr:hover { background-color: #f9f9f9; }
    .filtro-container { margin: 30px 0 20px 0; background-color: #ffffff; padding: 25px; border-radius: 2px; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); }
    .filtro-container h3 { margin-bottom: 20px; color: #333; }
    .filtros-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 16px; }
    .filtro-box { display: flex; flex-direction: column; position: relative; }
    .filtro-box button { padding: 10px 14px; background-color: #f1f1f1; border: 1px solid #ccc; border-radius: 2px; font-size: 14px; text-align: left; cursor: pointer; transition: background-color 0.2s; }
    .filtro-box button:hover { background-color: #e6e6e6; }
    .filtro-input { margin-top: 8px; padding: 10px 12px; border: 1px solid #ccc; border-radius: 2px; font-size: 14px; display: none; }
    .departamento-grupo { display: flex; justify-content: space-between; align-items: center; background-color: #fff; padding: 14px 18px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 2px; box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05); }
    .departamento-titulo { font-weight: 600; font-size: 16px; color: #333; }
    .departamento-grupo button { padding: 8px 14px; background-color: #e07b3c; color: white; border: none; border-radius: 2px; cursor: pointer; font-weight: 500; transition: background-color 0.2s ease; margin-left: 8px; }
    .departamento-grupo button:hover { background-color: #cf6a2b; }
    .departamento-botoes { display: flex; gap: 8px; flex-wrap: wrap; }
    .btn-bonificacoes { background-color: #28a745 !important; }
    .btn-bonificacoes:hover { background-color: #218838 !important; }
    .bonificacoes-container { background-color: #fff; border-radius: 2px; padding: 20px; margin: 20px 0; box-shadow: 0 1px 3px rgba(0,0,0,0.1); display: none; }
    .podium-container { display: flex; justify-content: space-around; gap: 20px; margin-top: 20px; flex-wrap: wrap; }
    .posicao-card { flex: 1; min-width: 280px; background: #ffffff; border-radius: 2px; padding: 20px; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1); border-top: 4px solid; }
    .posicao-card.primeiro { border-top-color: #ffd700; }
    .posicao-card.segundo { border-top-color: #c0c0c0; }
    .posicao-card.terceiro { border-top-color: #cd7f32; }
    .posicao-badge { display: inline-block; background: #e07b3c; color: white; padding: 4px 12px; border-radius: 2px; font-weight: 600; font-size: 0.9em; margin-bottom: 10px; }
    .funcionario-nome { font-weight: bold; font-size: 1.1em; color: #333; margin-bottom: 8px; }
    .funcionario-info { color: #666; font-size: 0.9em; margin-bottom: 15px; }
    .cha-scores { background-color: #f8f9fa; border-radius: 2px; padding: 15px; margin-top: 15px; text-align: left; border: 1px solid #e0e0e0; }
    .cha-scores h4 { margin: 0 0 12px 0; color: #333; font-size: 0.95em; font-weight: 600; }
    .cha-item { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; padding: 8px; background: white; border-radius: 2px; border: 1px solid #e0e0e0; }
    .cha-label { font-weight: 600; color: #e07b3c; }
    .cha-valor { font-weight: bold; color: #333; font-size: 1.1em; }
    .bonificacao-ia-container { margin-top: 15px; border-top: 2px solid #28a745; padding-top: 15px; background: #f8f9fa; border-radius: 2px; padding: 15px; border: 1px solid #e0e0e0; }
    .bonificacao-ia-header { display: flex; align-items: center; gap: 8px; margin-bottom: 12px; color: #2e7d32; font-weight: 600; }
    .bonificacao-ia-titulo { font-size: 1.05em; font-weight: bold; color: #1b5e20; margin-bottom: 10px; padding: 10px; background: white; border-radius: 2px; border-left: 3px solid #4caf50; }
    .bonificacao-ia-detalhes { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; flex-wrap: wrap; gap: 8px; }
    .bonificacao-valor { background: #4caf50; color: white; padding: 6px 14px; border-radius: 2px; font-weight: 700; font-size: 1.1em; display: inline-flex; align-items: center; gap: 5px; }
    .bonificacao-categoria { background: #fff9c4; color: #f57f17; padding: 4px 12px; border-radius: 2px; font-weight: 600; font-size: 0.85em; border: 1px solid #fbc02d; }
    .bonificacao-peso { background: #e3f2fd; color: #1565c0; padding: 4px 12px; border-radius: 2px; font-weight: 600; font-size: 0.85em; border: 1px solid #64b5f6; }
    .hobbies-container { background: white; padding: 12px; border-radius: 2px; margin-top: 10px; border: 1px solid #e0e0e0; }
    .hobbies-titulo { font-weight: 600; color: #666; font-size: 0.85em; margin-bottom: 8px; }
    .hobby-tag { display: inline-block; background: #e3f2fd; color: #1976d2; padding: 4px 10px; border-radius: 2px; font-size: 0.8em; margin-right: 6px; margin-bottom: 6px; border: 1px solid #90caf9; }
    .sem-hobbies { color: #999; font-style: italic; font-size: 0.85em; }
    .loading { text-align: center; color: #6b7280; font-style: italic; }
    .error { color: #dc2626; background-color: #fee2e2; padding: 12px; border-radius: 2px; margin: 10px 0; border-left: 3px solid #dc2626; }
    .success { color: #15803d; background-color: #d1fae5; padding: 12px; border-radius: 2px; margin: 10px 0; border-left: 3px solid #15803d; }
    
    /* BOT√ïES FIXOS PADRONIZADOS */
    .action-buttons { 
      position: fixed; 
      bottom: 30px; 
      right: 30px; 
      display: flex; 
      gap: 10px; 
      z-index: 1000; 
    }
    .btn-action { 
      padding: 12px 24px; 
      border: none; 
      border-radius: 4px;
      font-weight: 600; 
      font-size: 14px;
      cursor: pointer; 
      transition: all 0.2s; 
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .btn-action:hover { 
      box-shadow: 0 4px 8px rgba(0,0,0,0.2); 
      transform: translateY(-1px);
    }
    .btn-refresh { 
      background-color: #28a745; 
      color: white; 
    }
    .btn-refresh:hover { 
      background-color: #218838; 
    }
    .btn-dashboard { 
      background-color: #2196F3; 
      color: white; 
    }
    .btn-dashboard:hover { 
      background-color: #1976d2; 
    }
    .btn-back { 
      background-color: #e07b3c; 
      color: white; 
    }
    .btn-back:hover { 
      background-color: #cf6a2b; 
    }
    
    .resumo-bonificacoes { background: #ffffff; color: #333; padding: 20px; border-radius: 2px; margin-bottom: 20px; text-align: center; border: 1px solid #e0e0e0; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    .resumo-stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px; margin-top: 15px; }
    .stat-item { background: #f8f9fa; padding: 15px; border-radius: 2px; border: 1px solid #e0e0e0; }
    .stat-number { font-size: 1.5em; font-weight: bold; margin-bottom: 5px; color: #e07b3c; }
    .stat-label { font-size: 0.9em; opacity: 0.7; }
    
    @media (max-width: 768px) { 
      .podium-container { flex-direction: column; } 
      .departamento-botoes { flex-direction: column; }
      .action-buttons { 
        bottom: 20px; 
        right: 20px; 
        flex-direction: column; 
      }
      .header-badges {
        flex-direction: column;
        gap: 5px;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="header-title">FYT ‚Äì Find Your Talent</div>
    <div class="header-badges">
      <span class="badge badge-cha">M√©todo CHA</span>
      <span class="badge badge-ia">IA Ativa</span>
    </div>
  </header>

  <div class="container">
    <h2>Relat√≥rio por Departamento</h2>
    <div id="status-container"><div class="loading">Carregando departamentos...</div></div>

    <div class="resumo-bonificacoes" id="resumoGeral" style="display: none;">
      <h3>Resumo Geral</h3>
      <div class="resumo-stats" id="statsGerais"></div>
    </div>

    <div class="botoes-relatorios" id="botoesDepartamentos"></div>

    <div id="bonificacoesContainer" class="bonificacoes-container"></div>

    <div class="filtro-container" id="filtroContainer" style="display: none;">
      <h3>Filtros</h3>
      <div class="filtros-grid">
        <div class="filtro-box"><button onclick="toggleInput('filtroPosicao')">Posi√ß√£o</button><input type="text" id="filtroPosicao" class="filtro-input" placeholder="Digite a posi√ß√£o..."></div>
        <div class="filtro-box"><button onclick="toggleInput('filtroScore')">Score</button><input type="text" id="filtroScore" class="filtro-input" placeholder="Digite o score..."></div>
        <div class="filtro-box"><button onclick="toggleInput('filtroMatricula')">Matr√≠cula</button><input type="text" id="filtroMatricula" class="filtro-input" placeholder="Digite a matr√≠cula..."></div>
        <div class="filtro-box"><button onclick="toggleInput('filtroNome')">Nome</button><input type="text" id="filtroNome" class="filtro-input" placeholder="Digite o nome..."></div>
        <div class="filtro-box"><button onclick="toggleInput('filtroCargo')">Cargo</button><input type="text" id="filtroCargo" class="filtro-input" placeholder="Digite o cargo..."></div>
        <div class="filtro-box"><button onclick="toggleInput('filtroConceito')">Conceito (CHA)</button><input type="text" id="filtroConceito" class="filtro-input" placeholder="Nota 1-5..."></div>
        <div class="filtro-box"><button onclick="toggleInput('filtroHabilidade')">Habilidade (CHA)</button><input type="text" id="filtroHabilidade" class="filtro-input" placeholder="Nota 1-5..."></div>
        <div class="filtro-box"><button onclick="toggleInput('filtroAtitude')">Atitude (CHA)</button><input type="text" id="filtroAtitude" class="filtro-input" placeholder="Nota 1-5..."></div>
      </div>
    </div>

    <table id="tabela-dados" style="display: none;">
      <thead id="cabecalho-tabela"></thead>
      <tbody id="corpo-tabela"></tbody>
    </table>
  </div>

  <div class="action-buttons">
    <button class="btn-action btn-refresh" onclick="location.reload()">
      üîÑ Atualizar
    </button>
    <button class="btn-action btn-dashboard" onclick="window.location.href='{{ url_for('dashboard')}}'">
      üìä Dashboard
    </button>
    <button class="btn-action btn-back" onclick="window.location.href='{{ url_for('upload')}}'">
      ‚¨ÖÔ∏è Voltar
    </button>
  </div>

  <script>
    const tabela = document.getElementById("tabela-dados");
    const cabecalhoTabela = document.getElementById("cabecalho-tabela");
    const corpoTabela = document.getElementById("corpo-tabela");
    const botoesDepartamentos = document.getElementById("botoesDepartamentos");
    const statusContainer = document.getElementById("status-container");
    const filtroContainer = document.getElementById("filtroContainer");
    const bonificacoesContainer = document.getElementById("bonificacoesContainer");
    const resumoGeral = document.getElementById("resumoGeral");
    const statsGerais = document.getElementById("statsGerais");

    const filtros = {
      "Posi√ß√£o": document.getElementById("filtroPosicao"),
      "Score": document.getElementById("filtroScore"),
      "Matr√≠cula": document.getElementById("filtroMatricula"),
      "Nome Completo": document.getElementById("filtroNome"),
      "Cargo": document.getElementById("filtroCargo"),
      "Conceito (1-5 Likert)": document.getElementById("filtroConceito"),
      "Habilidade (1-5 Likert)": document.getElementById("filtroHabilidade"),
      "Atitude (1-5 Likert)": document.getElementById("filtroAtitude")
    };

    let dadosCompletos = {};
    let dadosAtuais = [];

    function toggleInput(id) {
      const input = document.getElementById(id);
      input.style.display = input.style.display === 'block' ? 'none' : 'block';
    }

    function renderizarTabela(dados) {
      cabecalhoTabela.innerHTML = "";
      corpoTabela.innerHTML = "";
      if (dados.length === 0) {
        corpoTabela.innerHTML = "<tr><td colspan='100%'>Nenhum dado encontrado.</td></tr>";
        return;
      }
      const headers = Object.keys(dados[0]);
      const trHead = document.createElement("tr");
      headers.forEach(header => {
        const th = document.createElement("th");
        th.textContent = header;
        trHead.appendChild(th);
      });
      cabecalhoTabela.appendChild(trHead);
      dados.forEach(item => {
        const tr = document.createElement("tr");
        headers.forEach(key => {
          const td = document.createElement("td");
          td.textContent = item[key] || "";
          tr.appendChild(td);
        });
        corpoTabela.appendChild(tr);
      });
    }

    function aplicarFiltros() {
      const filtrados = dadosAtuais.filter(item => {
        return Object.keys(filtros).every(campo => {
          const input = filtros[campo].value.toLowerCase();
          return !input || item[campo]?.toString().toLowerCase().includes(input);
        });
      });
      renderizarTabela(filtrados);
    }

    function ocultarTodosConteudos() {
      tabela.style.display = 'none';
      filtroContainer.style.display = 'none';
      bonificacoesContainer.style.display = 'none';
    }

    function prepararTabela(dados, nomeDepartamento) {
      ocultarTodosConteudos();
      dadosAtuais = dados;
      Object.values(filtros).forEach(input => {
        input.value = '';
        input.removeEventListener("input", aplicarFiltros);
        input.addEventListener("input", aplicarFiltros);
      });
      tabela.style.display = 'table';
      filtroContainer.style.display = 'block';
      const titulo = document.querySelector('h2');
      titulo.textContent = `Funcion√°rios ‚Äì ${nomeDepartamento}`;
      renderizarTabela(dadosAtuais);
    }

    function mostrarBonificacoes(bonificacoes, nomeDepartamento) {
      ocultarTodosConteudos();
      bonificacoesContainer.style.display = 'block';
      const titulo = document.querySelector('h2');
      titulo.textContent = `Top 3 ‚Äì ${nomeDepartamento}`;

      if (!bonificacoes || bonificacoes.length === 0) {
        bonificacoesContainer.innerHTML = '<p style="text-align: center; color: #666;">Nenhuma bonifica√ß√£o dispon√≠vel.</p>';
        return;
      }

      let html = '<div class="podium-container">';
      
      bonificacoes.slice(0, 3).forEach((bonus, index) => {
        const posicaoClass = index === 0 ? 'primeiro' : index === 1 ? 'segundo' : 'terceiro';
        const posicaoTexto = `${index + 1}¬∫ Lugar`;
        
        const score = bonus["Score"] || '0.00';
        const conceito = bonus["Conceito"] || bonus["Conceito (1-5 Likert)"] || '‚Äî';
        const habilidade = bonus["Habilidade"] || bonus["Habilidade (1-5 Likert)"] || '‚Äî';
        const atitude = bonus["Atitude"] || bonus["Atitude (1-5 Likert)"] || '‚Äî';
        
        const bonificacaoSugerida = bonus["Bonifica√ß√£o Sugerida"] || bonus["Bonifica√É¬ß√É¬£o Sugerida"] || null;
        const valorSugerido = bonus["Valor Sugerido (R$)"] || 0;
        const categoria = bonus["Categoria"] || "N√£o categorizado";
        const pesoPos = bonus["Peso Posi√ß√£o"] || bonus["Peso Posi√É¬ß√É¬£o"] || null;
        const descricaoPeso = bonus["Descri√ß√£o Peso"] || bonus["Descri√É¬ß√É¬£o Peso"] || "";
        
        const hobby1 = bonus["Hobby 1"] || "";
        const hobby2 = bonus["Hobby 2"] || "";
        const hobby3 = bonus["Hobby 3"] || "";
        const hobbies = [hobby1, hobby2, hobby3].filter(h => h && h.trim() !== '' && h.toLowerCase() !== 'n/a');
        
        html += `
          <div class="posicao-card ${posicaoClass}">
            <div class="posicao-badge">${posicaoTexto}</div>
            <div class="funcionario-nome">${bonus["Nome Completo"] || 'Nome n√£o informado'}</div>
            <div class="funcionario-info">
              <strong>Score CHA:</strong> ${score}<br>
              <strong>Cargo:</strong> ${bonus["Cargo"] || 'N√£o informado'}
            </div>
            
            <div class="cha-scores">
              <h4>Avalia√ß√µes CHA (Likert 1-5)</h4>
              <div class="cha-item">
                <span class="cha-label">Conceito (Conhecimento)</span>
                <span class="cha-valor">${conceito}/5</span>
              </div>
              <div class="cha-item">
                <span class="cha-label">Habilidade</span>
                <span class="cha-valor">${habilidade}/5</span>
              </div>
              <div class="cha-item">
                <span class="cha-label">Atitude</span>
                <span class="cha-valor">${atitude}/5</span>
              </div>
            </div>`;
        
        if (bonificacaoSugerida) {
          html += `
            <div class="bonificacao-ia-container">
              <div class="bonificacao-ia-header">
                Bonifica√ß√£o Personalizada por IA
              </div>
              
              <div class="bonificacao-ia-titulo">
                ${bonificacaoSugerida}
              </div>
              
              <div class="bonificacao-ia-detalhes">
                <span class="bonificacao-valor">
                  R$ ${parseFloat(valorSugerido).toFixed(2)}
                </span>
                <span class="bonificacao-categoria">
                  ${categoria}
                </span>
                ${pesoPos ? `<span class="bonificacao-peso">${(pesoPos * 100).toFixed(0)}%</span>` : ''}
              </div>
              
              ${descricaoPeso ? `<div style="font-size: 0.8em; color: #666; margin-top: 8px; text-align: center;">
                <em>${descricaoPeso}</em>
              </div>` : ''}
              
              <div class="hobbies-container">
                <div class="hobbies-titulo">
                  Hobbies analisados:
                </div>
                ${hobbies.length > 0 
                  ? hobbies.map(h => `<span class="hobby-tag">${h}</span>`).join('') 
                  : '<span class="sem-hobbies">Nenhum hobby informado</span>'
                }
              </div>
            </div>`;
        } else {
          html += `
            <div style="margin-top: 15px; padding: 12px; background: #fff3cd; border-radius: 2px; border-left: 3px solid #ffc107;">
              <div style="font-size: 0.85em; color: #856404;">
                <strong>Bonifica√ß√£o padr√£o:</strong> Vale-presente multiuso no valor de R$ 100,00
              </div>
            </div>`;
        }
        
        html += `</div>`;
      });
      
      html += '</div>';
      bonificacoesContainer.innerHTML = html;
    }

    function criarGrupoDepartamento(departamento, dados, bonificacoes) {
      const grupo = document.createElement('div');
      grupo.className = 'departamento-grupo';
      
      const titulo = document.createElement('div');
      titulo.className = 'departamento-titulo';
      
      const top3 = bonificacoes?.slice(0, 3) || [];
      const comIA = top3.filter(b => b["Bonifica√ß√£o Sugerida"] || b["Bonifica√É¬ß√É¬£o Sugerida"]).length;
      const badgeIA = comIA > 0 ? ` <span style="background: #4caf50; color: white; padding: 2px 8px; border-radius: 2px; font-size: 0.75em;">${comIA} IA</span>` : '';
      
      titulo.innerHTML = `${departamento} <span style="color: #999; font-weight: normal;">(${dados.length} funcion√°rios | Top 3)</span>${badgeIA}`;
      
      const botoes = document.createElement('div');
      botoes.className = 'departamento-botoes';
      
      const btnDados = document.createElement('button');
      btnDados.textContent = `Funcion√°rios`;
      btnDados.onclick = () => prepararTabela(dados, departamento);
      
      const btnBonificacoes = document.createElement('button');
      btnBonificacoes.className = 'btn-bonificacoes';
      btnBonificacoes.textContent = `Top 3`;
      btnBonificacoes.onclick = () => mostrarBonificacoes(bonificacoes, departamento);
      
      botoes.appendChild(btnDados);
      botoes.appendChild(btnBonificacoes);
      grupo.appendChild(titulo);
      grupo.appendChild(botoes);
      return grupo;
    }

    fetch("https://iafyt5.app.n8n.cloud/webhook/relatorios")
      .then(res => { if (!res.ok) throw new Error(`HTTP ${res.status}`); return res.json(); })
      .then(data => {
        statusContainer.innerHTML = '';
        dadosCompletos = data;
        
        console.log('üìä Dados recebidos:', data);
        
        const relatorios = data.relatorios || {};
        const bonificacoes = data.bonificacoes_com_hobbies || data.bonificacoes || {};
        
        let dadosPresentes = false;
        let totalFuncionarios = 0;
        let totalTop3 = 0;
        let totalComIA = 0;
        
        for (const departamento in relatorios) {
          const dados = relatorios[departamento];
          if (Array.isArray(dados) && dados.length > 0) {
            dadosPresentes = true;
            totalFuncionarios += dados.length;
            
            const bonifDept = bonificacoes[departamento] || [];
            totalTop3 += Math.min(3, bonifDept.length);
            
            const comIA = bonifDept.filter(b => b["Bonifica√ß√£o Sugerida"] || b["Bonifica√É¬ß√É¬£o Sugerida"]).length;
            totalComIA += comIA;
            
            const grupo = criarGrupoDepartamento(departamento, dados, bonifDept);
            botoesDepartamentos.appendChild(grupo);
          }
        }
        
        if (!dadosPresentes) {
          statusContainer.innerHTML = '<div class="error">‚úï Nenhum departamento retornou dados.</div>';
        } else {
          resumoGeral.style.display = 'block';
          statsGerais.innerHTML = `
            <div class="stat-item">
              <div class="stat-number">${Object.keys(relatorios).length}</div>
              <div class="stat-label">Departamentos</div>
            </div>
            <div class="stat-item">
              <div class="stat-number">${totalFuncionarios}</div>
              <div class="stat-label">Funcion√°rios</div>
            </div>
            <div class="stat-item">
              <div class="stat-number">${totalTop3}</div>
              <div class="stat-label">Top 3 Selecionados</div>
            </div>
            <div class="stat-item">
              <div class="stat-number">${totalComIA}</div>
              <div class="stat-label">An√°lises de IA</div>
            </div>
          `;
          
          const msgIA = totalComIA > 0 
            ? ` | <span style="color: #4caf50; font-weight: bold;">‚úì ${totalComIA} bonifica√ß√µes com IA ativa</span>` 
            : ' | <span style="color: #ff9800;">‚ö† Sem an√°lise de IA</span>';
          
          statusContainer.innerHTML = `<div class="success">‚úì ${Object.keys(relatorios).length} departamentos carregados!${msgIA}</div>`;
        }
      })
      .catch(error => {
        console.error('Erro:', error);
        statusContainer.innerHTML = `<div class="error">‚úï Erro ao carregar: ${error.message}</div>`;
      });
  </script>
</body>
</html>